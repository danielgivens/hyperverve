function init(){$audio&&($body.addClass("audio"),loadSound("assets/audio/loop.mp3")),container=document.createElement("div"),document.body.appendChild(container),camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,5e3),camera.position.z=3e3;var a="assets/images/cube/hv/",b=".png",c=[a+"posx"+b,a+"posx"+b,a+"posx"+b,a+"posx"+b,a+"posx"+b,a+"posz"+b],d=(new THREE.CubeTextureLoader).load(c);d.format=THREE.RGBFormat,scene=new THREE.Scene,scene.background=d;var e=new THREE.AmbientLight(16777215);scene.add(e),pointLight=new THREE.PointLight(16777215,2),scene.add(pointLight);var f=(new THREE.CubeTextureLoader).load(c);f.mapping=THREE.CubeRefractionMapping,f.format=THREE.RGBFormat;var g=(new THREE.MeshLambertMaterial({color:16737792,envMap:d,combine:THREE.MixOperation,reflectivity:.3}),new THREE.MeshLambertMaterial({color:16777215,envMap:f,refractionRatio:.95}));new THREE.MeshLambertMaterial({color:16777215,envMap:d});renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement);var h=["assets/models/hv2.json"],i=new THREE.JSONLoader;i.load(h[0],function(a){createScene(a,g)}),composer=new THREE.EffectComposer(renderer),composer.addPass(new THREE.RenderPass(scene,camera)),glitchPass=new THREE.GlitchPass,glitchPass.renderToScreen=!0,composer.addPass(glitchPass),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function createScene(a,b){var c=400,d=new THREE.Mesh(a,b);d.position.z=0,d.scale.x=d.scale.y=d.scale.z=c,model=new THREE.Object3D,model.add(d),model.rotation.set(0,0,0),scene.add(model),render()}function onDocumentMouseDown(a){glitchPass.goWild=!0,$speed=-.05,model.scale.set(4,4,4),$enableMove=!0,$body.addClass("pressed"),$audio&&sound&&(sound.playbackRate.value=1)}function onDocumentMouseMove(a){mouseX=3*(a.clientX-windowHalfX),mouseY=3*(a.clientY-windowHalfY),$enableMove&&$audio&&sound&&(sound.detune.value=(a.clientY-windowHalfY)/2),e=a,pauseEvent(e)}function pauseEvent(a){return a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,!1}function onDocumentMouseUp(a){$speed=.005,glitchPass.goWild=!1,$enableMove=!1,model.scale.set(1,1,1),camera.position.x=0,camera.position.y=0,camera.position.z=3e3,$body.removeClass("pressed"),$audio&&sound&&(sound.playbackRate.value=.25,sound.detune.value=0)}function animate(){requestAnimationFrame(animate),$mesh&&($m++,$m>2&&(model.rotation.y-=$speed)),render()}function render(){-2e-4*Date.now();$enableMove&&(camera.position.x+=mouseX-camera.position.x,camera.position.y+=-mouseY-camera.position.y),camera.lookAt(scene.position),composer.render(scene,camera)}function loadSound(a){var b=new XMLHttpRequest;b.open("GET",a,!0),b.responseType="arraybuffer",b.onload=function(){audioContext.decodeAudioData(b.response,function(a){a.duration;sampleBuffer=a,playSound()})},b.send()}function setupSound(){sound=audioContext.createBufferSource(),sound.buffer=sampleBuffer,sound.loop=loop,sound.loopStart=0,sound.loopEnd=sampleBuffer.duration,sound.connect(audioContext.destination),sound.playbackRate.value=.2}function playSound(){setupSound(),sound.start(0)}function stopSound(){sound.stop(0)}var container,stats,camera,scene,renderer,mesh,geometry,model;$body=$("body");var loader;$y=0,$m=0;var pointLight;$speed=.005;var mouseX=0,mouseY=0;$mesh=!1;var windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;$enableMove=!1,$audio=!1;var a=document.createElement("audio");if($audio=!(!a.canPlayType||!a.canPlayType("audio/mpeg;").replace(/no/,"")),alert($audio),$audio)var audioContext=new(window.AudioContext||window.webkitAudioContext),sampleBuffer,sound,loop=!0,pannner=audioContext.createStereoPanner();init(),animate(),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("touchstart",onDocumentMouseDown,!1),document.addEventListener("mouseup",onDocumentMouseUp,!1),document.addEventListener("touchend",onDocumentMouseUp,!1),$("#mute").click(function(){$body.hasClass("muted")?(playSound(),$body.removeClass("muted")):(stopSound(),$body.addClass("muted"))}),THREE.DefaultLoadingManager.onProgress=function(a,b,c){b===c&&($mesh=!0)};